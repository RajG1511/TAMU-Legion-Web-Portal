<!-- Header Strip -->
<div class="container-fluid bg-dark-gray-blue text-white py-3">
    <h1 class="text-center font-primary-title">Resources</h1>
</div>

<!-- Gold Divider -->
<div class="container-fluid bg-gold py-1"></div>

<!-- Main Body Section -->
<div class="container-fluid bg-dark-navy text-white pt-4 pb-5 min-vh-100 border-bottom border-12 border-gold">

    <div class="default-padding">
        <!-- Display resources if any exist -->
        <% if @resources.any? %>

            <!-- Category Filter Bar -->
            <div class="bg-white d-flex align-items-center gap-2 px-3 py-2 mb-0 text-dark-navy" style="max-width: 375px;">
            <span class="fw-bold font-secondary-body mb-0">Filter by Category:</span>

            <%= form_with url: resources_path, method: :get, local: true, class: "d-flex gap-2 mb-0" do %>
                <%= select_tag :category_id,
                    options_for_select([["All", ""]] + ResourceCategory.pluck(:name, :id), params[:category_id]),
                    include_blank: false,
                    class: "form-select text-dark-navy rounded-0" %>
                <%= submit_tag "Filter", class: "btn btn-gold font-secondary-body rounded-0" %>
            <% end %>
            </div>

            <% if current_user&.exec? %>
            <div class="font-secondary-body text-dark-navy mb-4" style="max-width: 600px;">
                <span class="text-gold fw-bold">Exec Only resources labeled in Gold</span>
            </div>
            <% end %>


            <!-- Resource Containers By Category -->
            <% ResourceCategory.order(:name).each do |category| %>
            <% resources_in_category = @resources.where(resource_category_id: category.id) %>
            <% next if resources_in_category.empty? %>

            <!-- Category Title -->
            <h2 class="font-primary-title mb-2 mt-4"><%= category.name %> Resources</h2>
            <hr class="border-white border-4 mb-3">

            <!-- Resource Buttons -->
            <div class="row g-3">
            <% resources_in_category.each do |resource| %>
                <div class="col-6 col-sm-4 col-md-3 col-lg-2">

                <!-- Container -->
                <div class="resource-card-btn position-relative">

                    <!-- Link Type -->
                    <% if resource.resource_type == "link" %>
                    <%= link_to resource.name, resource.content, target: "_blank", rel: "noopener", class: "resource-btn d-flex align-items-center justify-content-center text-center font-primary-heading #{'execs-text' if resource.visibility == 'execs_only'}" %>

                    <!-- File Type -->
                    <% elsif resource.resource_type == "file" && resource.file.attached? %>
                    <div class="resource-card-btn resource-card-btn-file d-flex flex-column justify-content-center text-center font-primary-heading">
                        <div class="d-flex w-100">
                        <%= link_to "View #{resource.name}", rails_blob_path(resource.file, disposition: "inline"),
                            target: "_blank", class: "resource-sub-btn view-file-border flex-fill #{'execs-text' if resource.visibility == 'execs_only'}" %>
                        <%= link_to "Download #{resource.name}", rails_blob_path(resource.file, disposition: "attachment"),
                            class: "resource-sub-btn flex-fill #{'execs-text' if resource.visibility == 'execs_only'}" %>
                        </div>
                    </div>
                    <% end %>

                </div>
                </div>
            <% end %>
            </div>
        
        <% end %>

        <% else %>
            <p class="text-white font-secondary-body px-2">No resources available.</p>
        <% end %>
    </div>
</div>

<!-- Gold Divider -->
<div class="container-fluid bg-gold py-1"></div>
