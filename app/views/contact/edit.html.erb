<% content_for :title, "Edit Contact Us" %>

<!-- Top Heading -->
<div class="container-fluid bg-dark-navy text-white py-3">
  <h1 class="text-center font-primary-title">Edit Contact Us Page</h1>
</div>

<!-- Main Body -->
<div class="container-fluid bg-gold py-2">
  <div class="row">

    <!-- LEFT COLUMN: Editable Sections -->
    <div class="col-md-7 bg-white text-dark-navy p-4 min-vh-100">

      <%= form_with url: contact_path, method: :patch, local: true do |f| %>

        <!-- Scrollable Edit Form Container -->
        <div class="overflow-auto pe-2 edit-scroll-container" style="max-height: 75vh; margin-left: 3vw;">

          <!-- HEADLINE -->
          <div class="edit-card p-4 mb-4">
            <h3 class="font-primary-title mb-2 text-white">Headline</h3>
            <p class="text-gold mb-0 font-primary-heading"><strong>Can Edit Headline</strong></p>
            <p class="text-white mb-0 font-secondary-body"><strong>Accepts Plaintext</strong></p>

            <div class="mt-3">
              <label class="font-secondary-subheading mb-2 text-white">Current Headline:</label>
              <%= text_field_tag "contact_page[hero_title]", @sections["hero_title"], class: "form-control default-border-radius edit-textarea font-secondary-subheading" %>
            </div>
          </div>

          <!-- MEETINGS SECTION -->
          <div class="edit-card p-4 mb-4">
            <h3 class="font-primary-title mb-2 text-white">Meetings Section</h3>
            <p class="text-gold mb-0 font-primary-heading"><strong>Can Edit Title, Body, Location, and Additional Info</strong></p>
            <p class="text-white mb-0 font-secondary-body"><strong>Body & Additional Accept HTML, All Fields Accept Plaintext</strong></p>

            <div class="mt-3">
              <label class="font-secondary-subheading mb-2 text-white">Current Title:</label>
              <%= text_field_tag "contact_page[meetings_title]", @sections["meetings_title"], class: "form-control default-border-radius edit-textarea font-secondary-subheading" %>
            </div>

            <div class="mt-3">
              <label class="font-secondary-subheading mb-2 text-white">Current Body:</label>
              <%= text_area_tag "contact_page[meetings_body_html]", @sections["meetings_body_html"], rows: 6, class: "form-control default-border-radius edit-textarea font-secondary-subheading" %>
            </div>

            <div class="mt-3">
              <label class="font-secondary-subheading mb-2 text-white">Current Location:</label>
              <%= text_field_tag "contact_page[meetings_location]", @sections["meetings_location"], class: "form-control default-border-radius edit-textarea font-secondary-subheading" %>
            </div>

            <div class="mt-3">
              <label class="font-secondary-subheading mb-2 text-white">Current Location URL:</label>
              <%= text_field_tag "contact_page[meetings_location_url]", @sections["meetings_location_url"], class: "form-control default-border-radius edit-textarea font-secondary-subheading" %>
            </div>

            <div class="mt-3">
              <label class="font-secondary-subheading mb-2 text-white">Current Additional Info:</label>
              <%= text_area_tag "contact_page[meetings_additional_html]", @sections["meetings_additional_html"], rows: 6, class: "form-control default-border-radius edit-textarea font-secondary-subheading" %>
            </div>
          </div>

          <!-- QUESTIONS SECTION -->
          <div class="edit-card p-4 mb-4">
            <h3 class="font-primary-title mb-2 text-white">Questions Section</h3>
            <p class="text-gold mb-0 font-primary-heading"><strong>Can Edit Title, Body, and Button</strong></p>
            <p class="text-white mb-0 font-secondary-body"><strong>Body Accepts HTML, All Fields Accept Plaintext</strong></p>

            <div class="mt-3">
              <label class="font-secondary-subheading mb-2 text-white">Current Title:</label>
              <%= text_field_tag "contact_page[questions_title]", @sections["questions_title"], class: "form-control default-border-radius edit-textarea font-secondary-subheading" %>
            </div>

            <div class="mt-3">
              <label class="font-secondary-subheading mb-2 text-white">Current Body:</label>
              <%= text_area_tag "contact_page[questions_body_html]", @sections["questions_body_html"], rows: 6, class: "form-control default-border-radius edit-textarea font-secondary-subheading" %>
            </div>

            <div class="mt-3">
              <label class="font-secondary-subheading mb-2 text-white">Current Button Label:</label>
              <%= text_field_tag "contact_page[questions_button_label]", @sections["questions_button_label"], class: "form-control default-border-radius edit-textarea font-secondary-subheading" %>
            </div>

            <div class="mt-3">
              <label class="font-secondary-subheading mb-2 text-white">Current Button URL:</label>
              <%= text_field_tag "contact_page[questions_button_url]", @sections["questions_button_url"], class: "form-control default-border-radius edit-textarea font-secondary-subheading" %>
            </div>
          </div>

          <!-- EMAIL LIST SECTION -->
          <div class="edit-card p-4 mb-4">
            <h3 class="font-primary-title mb-2 text-white">Email List Section</h3>
            <p class="text-gold mb-0 font-primary-heading"><strong>Can Edit Title, Body, and Button</strong></p>
            <p class="text-white mb-0 font-secondary-body"><strong>Body Accepts HTML, All Fields Accept Plaintext</strong></p>

            <div class="mt-3">
              <label class="font-secondary-subheading mb-2 text-white">Current Title:</label>
              <%= text_field_tag "contact_page[email_list_title]", @sections["email_list_title"], class: "form-control default-border-radius edit-textarea font-secondary-subheading" %>
            </div>

            <div class="mt-3">
              <label class="font-secondary-subheading mb-2 text-white">Current Body:</label>
              <%= text_area_tag "contact_page[email_list_body_html]", @sections["email_list_body_html"], rows: 6, class: "form-control default-border-radius edit-textarea font-secondary-subheading" %>
            </div>

            <div class="mt-3">
              <label class="font-secondary-subheading mb-2 text-white">Current Button Label:</label>
              <%= text_field_tag "contact_page[email_list_button_label]", @sections["email_list_button_label"], class: "form-control default-border-radius edit-textarea font-secondary-subheading" %>
            </div>

            <div class="mt-3">
              <label class="font-secondary-subheading mb-2 text-white">Current Button URL:</label>
              <%= text_field_tag "contact_page[email_list_button_url]", @sections["email_list_button_url"], class: "form-control default-border-radius edit-textarea font-secondary-subheading" %>
            </div>
          </div>

        </div>

        <!-- Buttons Below Scrollable Form -->
        <div class="d-flex justify-content-start gap-3 mt-4" style="margin-left: 3vw;">
          <%= f.submit "Save", class: "btn btn-gold text-dark-navy font-secondary-body default-border-radius" %>
          <%= link_to "Cancel", root_path, class: "btn btn-gold text-dark-navy font-secondary-body default-border-radius" %>
        </div>

      <% end %>
    </div>

    <!-- RIGHT COLUMN: Update Log -->
    <div class="col-md-5 bg-legion-blue text-white p-4 min-vh-100">

      <!-- User Guide Button -->
      <div style="padding-left: 3vw; padding-right: 3vw;">
        <button type="button" class="btn white-btn-edit mb-3 default-border-radius btn-lg font-primary-heading w-100"
          data-bs-toggle="modal" data-bs-target="#UserGuideModal">
          User Guide: Editing Contact Us Page
        </button>
      </div>

      <!-- Update Log Table -->
      <div class="table-responsive log-scroll-container" style="max-height: 75vh; overflow-y: auto; padding-left: 3vw; padding-right: 3vw;">
        <table class="table table-bordered table-striped border-white">
          <thead>
            <tr>
              <th colspan="2" class="bg-white text-dark text-center h5 font-secondary-heading">Update Log</th>
            </tr>
            <tr>
              <th class="bg-legion-blue text-white font-secondary-body border-white">Updated By</th>
              <th class="bg-legion-blue text-white font-secondary-body border-white">Timestamp</th>
            </tr>
          </thead>
          <tbody>
            <% (@contact_versions || []).each do |version| %>
              <tr>
                <td class="font-secondary-subheading"><%= version.user.first_name %> <%= version.user.last_name %></td>
                <td class="font-secondary-subheading"><%= version.created_at.in_time_zone("Central Time (US & Canada)").strftime("%B %d, %Y at %I:%M %p") %></td>
              </tr>
            <% end %>
            <% if @contact_versions.blank? %>
              <tr>
                <td colspan="2" class="text-center font-secondary-subheading text-black">
                  No updates logged yet.
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>

    </div> 

  </div> 
</div> 

<!-- User Guide Modal -->
<div class="modal fade edit-info-modal" id="UserGuideModal" tabindex="-1" aria-labelledby="UserGuideModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">

      <!-- Modal Header -->
      <div class="modal-header">
        <h5 class="modal-title font-primary-heading" id="UserGuideModalLabel">Contact Us Edit Guide</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>

      <!-- Modal Body -->
      <div class="modal-body font-secondary-subheading">
        <p>
          Welcome to the Contact Us Page Editing Guide! 
          Here youâ€™ll find information on how to view and manage the Contact Us Page.
        </p>

        <h6 class="font-secondary-body text-gold mt-4">Editing the Contact Us Page</h6>
        <ul class="font-secondary-subheading">
          <li>Each section of the Contact Us Page can be edited by going to the corresponding section form.</li>
          <li>Each form showcases the current section that is editable, the fields that can be edited and how, and the current values.</li>
          <li>Click each field under "Current" to edit its text/HTML.</li>
          <li>Any and All changes will need to be saved located at the bottom of the form where a flash message should appear upon completion.</li>
          <li>Once saved, the changes will be reflected on the Contact Us Page.</li>
          <li>Any issues upon saving will be indicated by an error flash message.</li>
          <li>Any HTML changes will be validated wtih restrictions on HTML inputs</li>
        </ul>

        <h6 class="text-gold mt-4 font-secondary-body">Understanding the Update Log</h6>
        <ul class="font-secondary-subheading">
          <li>Whoever edits the Contact Us Page is recorded in the Update Log.</li>
          <li>The log allows for admin to track any mistakes made in updates.</li>
        </ul>
      </div>

      <!-- Modal Footer -->
      <div class="modal-footer">
        <button type="button" class="btn btn-gold text-dark-navy font-secondary-body" data-bs-dismiss="modal">
          Close
        </button>
      </div>

    </div>
  </div>
</div>
